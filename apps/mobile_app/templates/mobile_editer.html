{% extends "mobile_base.html" %} 
{% block title %} 拼爱网 --个人信息{{type}}{% endblock %}
{% block staticfiles %}
<link rel="stylesheet" type="text/css" href="/static/css/idangerous.swiper.css" />
<script src="/static/js/idangerous.swiper.min.js" type="text/javascript" charset="utf-8"></script>
{% endblock %}
{% block js%}
<script>
$.fn.serializeObject = function() {
    var o = {};
    var a = this.serializeArray();
    $.each(a, function() {
        if (o[this.name]) {
            if (!o[this.name].push) {
                o[this.name] = [ o[this.name] ];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
}
$(function(){
 $('#send').click(function(){
   var type=$('#type').val();
   var content=$('#content').val();
   if(content.length==0){
	   $.poplayer({body:'内容不能为空!'});
	   return false;
   }
     var json=$('form').serializeObject();
     $.ajax({
					type:'POST',
					url:'{{url}}',
					dataType:"json",
					data:json,
					success:function(data, textStatus){
						if(textStatus=='success'){
							if(data['result']=='success'){
								var body = $("<p>发送成功!</p>");
								$.poplayer({body:body});
								window.history.go(-1);
							}else if(data['result']=='error'){
								var body = $("<p>"+data['error_message']+"<p>");
								$.poplayer({body:body});
							}
						}
						
					},
					error:function(response){
						var body = $("<p>网络异常!</p>")
			       	    $.poplayer({body:body});
					},
			});
 });
});

</script>
{% endblock %}
{% block content%}	

	<body class="logined">
	<form>{%csrf_token%}
		<div class="header">
			<div class="row">
				<div class="col-xs-2">
					<i class="glyphicon glyphicon-chevron-left" onclick="window.history.go(-1)"></i>
				</div>
				<div class="col-xs-7">
					edit
				</div>
				<div class="col-xs-3">
				<a id='send' href="javascript:void(0);">发送</a>
				</div>
			</div>
		</div>

		<div class="container">
			<div class="row frame">
				{{textarea|safe}}
				<div class="editer-btns">
			    <span class="emotion"></span>
				{{inputHtml|safe}}
				</div>
			</div>
			<!--<center class="button">
				<button class="btn btn-success btn-lg">发送</button>
			</center>-->
		</div>
		<script type="text/javascript">
			$('.photo').click(function() {
				$('#uploadphoto').click();
			});
			$(function() {
				$('.emotion').qqFace({
					id: 'facebox',
					assign: 'content',
					path: '/static/img/arclist/' //表情存放的路径
				});
				//				$(".sub_btn").click(function(){
				//					var str = $("#saytext").val();
				//					$("#show").html(replace_em(str));
				//				});
			});
			 //			//查看结果
			 //			function replace_em(str){
			 //				str = str.replace(/\</g,'&lt;');
			 //				str = str.replace(/\>/g,'&gt;');
			 //				str = str.replace(/\n/g,'<br/>');
			 //				str = str.replace(/\[em_([0-9]*)\]/g,'<img src="arclist/$1.gif" border="0" />');
			 //				return str;
			 //			}
			 //			$(".header").on("swipeleft",function(){
			 //			  alert("You swiped left!");
			 //			});
		</script>
	   </form>
	</body>

{% endblock%}