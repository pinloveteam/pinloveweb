<link href="{{STATIC_URL}}css/venobox.css" rel="stylesheet">
<link href="{{STATIC_URL}}css/jquery.jscrollpane.css" rel="stylesheet">
<link href="{{STATIC_URL}}css/card.css" rel="stylesheet">
<link href="{{STATIC_URL}}css/hopscotch-0.1.2.min.css" rel="stylesheet">
<script type="text/javascript" src="{{STATIC_URL}}js/jquery.jscrollpane.min.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/jquery.mousewheel.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/venobox.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/Chart.min.js"></script>
<script src="{{STATIC_URL}}js/hopscotch-0.1.2.min.js" type="text/javascript"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/Card.js"></script>
<script type="text/javascript" src="{{STATIC_URL}}js/jquery.follow.js"></script>
<style>
.publishInputExpression {
background: url("/static/img/pop_expression.gif") no-repeat scroll left center rgba(0, 0, 0, 0);
padding-left: 21px;
display: inline;
}
</style>
<!-- detail_info -->

<script type="text/javascript">

//下一页
{% if pages.has_next %}
var next_page_number={{pages.next_page_number}}
{%else%}
var next_page_number=-1
{% endif %}
//上一页
{% if pages.has_previous %}
var previous_page_number={{pages.previous_page_number}}
{%else%}
var previous_page_number=-1
{% endif %}

//关注
var myFollow={% if myFollow %}{{myFollow}}{%else%}0{% endif %}
var follow={% if follow %}{{follow}}{%else%}0{% endif %}
var fans={% if fans %}{{fans}}{%else%}0{% endif %}

$(document).ready(function(){
	if (previous_page_number<0){
		$('.prev').hide();
	}
	if(next_page_number<0){
		$('.next').hide();
	}
	//下一页
	$('.next').click(function(){
		
		var choseCardslist = new Array();　
		var choseCards=$('.card_row').children().not('.hideable').not('.controlArrow');
		var choseCardsSize=choseCards.length
		if (choseCardsSize>=8){
			alert('选中项大于等于8个')
		}
		if (choseCardsSize>0){
			for(i=0;i<choseCardsSize;i++){
				choseCardslist[i]=parseInt(choseCards[i].id)
			 }
		}
		var preCard = $('.card_row').children('.hideable');
		var size = preCard.hide('slow').removeClass('hideable').size();
		
		 $.getJSON(window.location.href,{ajax:true,page:next_page_number,choseCards:choseCardslist},function(data) {
			 if(data['result']=='success'){
				 if (data['has_next']){
					 next_page_number=data['next_page_number'];
				 }else{
					 next_page_number=-1;
					 $('.next').hide();
				 }
				 $('.prev').show();
				 previous_page_number=data['previous_page_number'];
				 var cards=data['cards'];
				 if  (data['removeCard']){
					 choseCardsSize=0
				 }
				 for(x=0;x<cards.length-choseCardsSize;x++){
						 new Card(new Person(cards[x].username,cards[x].age,cards[x].city,'/media/'+cards[x].avatar_name,cards[x].user_id,cards[x].followStatus,cards[x].pictureList,cards[x].isChat));
					 } 
				 preCard.remove();
				 venobox();
			 }
		 });
	});
	
	//上一页
	$('.prev').click(function(){
		var choseCardslist = new Array();　
		var choseCards=$('.card_row').children().not('.hideable').not('.controlArrow');
		var choseCardsSize=choseCards.length
		if (choseCardsSize>=8){
			alert('选中项大于等于8个')
		}
		if (choseCardsSize>0){
			for(i=0;i<choseCardsSize;i++){
				choseCardslist[i]=parseInt(choseCards[i].id)
			 }
		}
		var nextCard = $('.card_row').children('.hideable');
		var size = nextCard.hide('slow').removeClass('hideable').size();
		//a = $('.card_row').children('.hideable').hide('slow').removeClass('hideable').size();
		 $.getJSON(window.location.href,{ajax:true,page:previous_page_number,choseCards:choseCardslist},function(data) {
			 if(data['result']=='success'){
				 if (data['has_previous']){
					 previous_page_number=data['previous_page_number'];
				 }else{
					 previous_page_number=-1;
					 $('.prev').hide();
				 }
				 next_page_number=data['next_page_number'];
				 $('.next').show();
				 var cards=data['cards'];
				 if  (data['removeCard']){
					 choseCardsSize=0
				 }
				 for(x=0;x<cards.length-choseCardsSize;x++){
					 new Card(new Person(cards[x].username,cards[x].age,cards[x].city,'/media/'+cards[x].avatar_name,cards[x].user_id,cards[x].followStatus,cards[x].pictureList,cards[x].isChat));
					 } 
				 nextCard.remove();
				 venobox();
			 }
		 });
		
	});
	
	
	//获取卡片集合
	var cards =jQuery.parseJSON('{{pages.object_list|safe }}');
	init_card(cards);
	pane = $('.chat');
	pane.jScrollPane();
	
});
function init_card(cards){
	for(y=0;y<cards.length;y++){
		new Card(new Person(cards[y].username,cards[y].age,cards[y].city,'/media/'+cards[y].avatar_name,cards[y].user_id,cards[y].followStatus,cards[y].pictureList,cards[y].isChat));
	}
	venobox();
};

function venobox(){
	$('.venobox').venobox({
		numeratio: true,
		border: '0'
	});
	$('.venoboxvid').venobox({
		bgcolor: '#000'
	});
	$('.venoboxframe').venobox({
		framewidth: '400px',
		frameheight: '551px',
		border: '6px',
	});
	$('.venoboxinline').venobox({
		framewidth: '300px',
		frameheight: '250px',
		border: '6px',
		bgcolor: '#f46f00'
	});
	$('.venoboxajax').venobox({
		framewidth: '400px',
		frameheight: '551px',
		border: '30px;'
	});
}

</script>


<div class="col-xs-9" style="margin-left: -50px;">
	<div id="compare_tip" class="alert alert-success alert-dismissable">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
		  点击其他用户<span class="text-danger"><strong>姓名</strong></span>进行对比。
	</div>
	<div class="row card_row" style="width:1040px;">
	</div>
	<!--  <div class="controlArrow prev" title="上一页"></div>
	<div class="controlArrow next" title="下一页"></div>
	-->
</div>
		
<!-- card clone -->
		
<div id="card" style="display: none;">
	<div class="card card_panel col-xs-6 hideable">
		<div class="tabbable">
			<div class="tab-content">
				<div class="tab-pane active" id="tab12">
					<div class="introBox">
						<img class="head" width="250px" src="">
						<div class="card-introBox" title="点击查看详细信息"></div>

						<div class="name">
							<a herf=""><span class="username"></a></span> <s class="name-arrow"></s>
							<i class="Q-buy-btn glyphicon  icon_like_0" title="喜欢" move-to="js-follow" move-data="./img/image1.jpeg"></i>
							<div class="tag">
								<span id="age" class="label label-success"></span>&nbsp;&nbsp;&nbsp;
								<span id="location" class="label label-danger"></span>
							</div>
						</div>
					</div>
					<div class="tool_bar">
						<a href="#"> <i class="icon_ding" title="固定"></i>
						</a>
						<!--
								<a href="javascript:void(0)"><i class="icon_ding" title="固定"></i></a>
			   	   	   	        <a href="javascript:void(0)"><i move-data="" move-to="js-follow" class="icon_like_0" title="喜欢"></i></a>
			   	   	   	   	   	<a href="javascript:void(0)"><i class="icon_dislike" title="不喜欢"></i></a>
							    -->
					</div>
				</div>
				<div class="tab-pane" id="tab13">
					<div class="scroller">
						<ul class="hoverbox"></ul>
					</div>
				</div>
				<div class="tab-pane chat_tab" id="tab10">
					<div id="chat_tab">
						<div class="chat"></div>
						<textarea rows="1" class="chat_textarea"></textarea>
						<button class="btn btn-xs btn-primary  btn_send_msg">发送</button>
					</div>
				</div>
			</div>
			<div class="btn-group card-nav">
				<button type="button" class="btn btn-default btn-lg" href="#tab12"
					data-toggle="tab" style="border-left: none;">
					<span class="glyphicon glyphicon-info-sign"></span>
				</button>
				<button type="button" class="btn btn-default btn-lg" href="#tab13"
					data-toggle="tab">
					<span class="glyphicon glyphicon-picture"></span>
				</button>
				<button type="button" class="btn btn-default btn-lg" href="#tab10"
					data-toggle="tab" style="border-right: none;">
					<span class="glyphicon glyphicon-comment"></span>
				</button>
			</div>
		</div>
	</div>
</div>